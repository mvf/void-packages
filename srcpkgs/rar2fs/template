# Template file for 'rar2fs'
pkgname=rar2fs
version=1.27.2
revision=1
create_wrksrc=yes
build_wrksrc="${pkgname}-${version}"
build_style=gnu-configure
configure_args="--prefix=/usr --with-unrar=../unrar"
makedepends="fuse-devel"
short_desc="FUSE file system for reading RAR archives"
maintainer="Matthias von Faber <mvf@gmx.eu>"
license="custom:freeware"
homepage="https://hasse69.github.io/rar2fs"
distfiles="
 https://github.com/hasse69/rar2fs/releases/download/v${version}/${pkgname}-${version}.tar.gz
 https://www.rarlab.com/rar/unrarsrc-5.8.2.tar.gz
"
checksum="
 2e9452751f7e2d349ed8ea525a62b00ab50504e15337f1bb162bf2cacfa88a55
 33386623fd3fb153b56292df4a6a69b457e69e1803b6d07b614e5fd22fb33dda
"
repository=nonfree

pre_configure() {
	pushd ../unrar
	vsed -e 's/^\(CXXFLAGS\)=\(.*\)/\1+=\2/' \
		 -e 's/^\(LDFLAGS\)=\(.*\)/\1+=-lpthread \2/' \
		 -i makefile
	make CXX="$CXX" LD="$LD" STRIP=: -f makefile lib
	popd
}

post_install() {
	vlicense ../unrar/license.txt LICENSE-UNRAR
}
